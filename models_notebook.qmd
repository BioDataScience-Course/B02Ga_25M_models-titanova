---
title: "Impact du microplastique sur les communautés microbiennes"
author: "Irma Gaziaux , Kelly Fodom, Lila Franchin , Arthur Miroux"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but (que vous remanierez éventuellement en fonction des modèles que vous ajouterez plus tard). Vous pouvez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

Les données viennent de l'étude expérimentale de Montaya et al. [-@Montoya2023] qui étudie comment les microplastiques impactent la structure des communautés microbiennes dans le mésocosme. On dispose de variables de structure telles que la proportion en HNA/LNA et de fonctionnalité (c'est-à-dire directement liées à la photosynthèse) telles que la concentration en ammonium et le taux de chlorophylle et l'absence ou la présence de certains microplastiques de différents types. Le but de cette étude est d'évaluer l'impact direct et indirect des microplastiques sur les populations phytoplanctoniques et bactériennes et l'effet sur la productivité marine, ce qui affecte tout l'écosystème marin étant donné que ces populations sont à la base de la chaine alimentaire.

## Matériel et méthodes

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets du premier module de SDD II. -->

Les données de cette étude proviennent du dépot Zenodo de @Montoya2023 . Le logiciel utilisé est R (version 4.4.1) (https://www.r-project.org) (`r R.version.string`). plus précisément, le package {modelit} version `r packageVersion("modelit")` dans la [SciViews Box 2025](https://www.sciviews.org/software/svbox/). [Saturn Cloud](https://saturncloud.io) (Linux Ubuntu 22.04). Ce package est utilisé afin d'exécuter le code et compiler la version finale de ce bloc-notes. Le jeu de données est remanié (documenté dans le fichier `R/import.R`).

## Analyses

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model", lang = "fr")
```

<!--% Importez les données que vous aurez préalablement nettoyées, remaniées et labélisées dans le script R nommé `R/import.R`. -->

```{r import}
# Lecture des données
microp <- read("data/microp.rds")
# Tableau des premières et dernières lignes
tabularise$headtail(microp)

```

### Description des données

<!--% Chaque étudiant réalise et interprète un graphique pertinent en lien avec le but fixé et les modèles qui seront réalisés. Graphique et interprétation de l'étudiant #1 ci-dessous. -->

```{r chart1}
chart(data=microp, chla_fluo ~plast_pet %col=% temp)+
  geom_point()
```

La masse de phytoplancton augmente avec la concentration en polyéthylène téréphtalate, particulièrement à des températures plus élevées. Cependant, cette relation semble non linéaire et complexe, probablement influencée par plusieurs facteurs environnementaux. Une interprétation plausible de cette tendance est que la présence de polyéthylène téréphtalate affecte le cycle de l’azote au sein des populations microbiennes. Le PET semble donc avoir un impact notable sur la communauté microbienne ce qui est à confirmer par des analyses statistiques plus approfondies.

<!--% Graphique et interprétation de l'étudiant #2 ci-dessous. -->

```{r chart2}
chart(data = microp, fvfm ~ plast_pvc %col=% depth_rec)+
  geom_point()
```

La concentration de Chlorure de polyvinyle augmente l'efficacité de la photosynthèse des phytoplancton. La profondeur de l'océan ne semble pas avoir d'impact sur l'efficacité de la photosynthèse. Tout de même les phytoplanctons les moins efficaces sont ceux en grande profondeur.

Le nuage de point montre une tendance qui s'apparente à une droite. Cependant le nuage de point ne forme pas une droite parfaite. Des analyses ultérieures seront nécessaires pour déterminer si ce modèle est bon.

<!--% Graphique et interprétation de l'étudiant #3 ci-dessous. -->

```{r chart3}
chart(data=microp, chla_fluo ~plast_tot %col=% temp_rec)+
  geom_point()
```

Les points sons assez espacés. On remarque la présence de valeurs extrêmes. On peut observer que quand la concentration en microplastique sera faible, la masse en phtoplancton le sera aussi. Cependant cette observation est à prendre avec des pincettes : on peut également remarquer une très grande concentration en microplastique mais une masse de phytoplancton moyenne.

<!--% Graphique et interprétation de l'étudiant #4 ci-dessous. -->

```{r chart4}
chart(data = microp, fvfm ~ ammonium %col=% mesocosm)+
  geom_point()
```

Ce graphique présente l'efficacité de la photosynthèse en fonction de la concentration de l'ammonium dans les différents mésocosmes. L'efficacité photosynthétique est très élevée pour des très faible concentration de l'ammonium. Cette dernière semble ne pas impacter sur l'efficacité photosynthétique. L'efficacité la plus élevée est observée dans le mésocosme 5 à 5,5.

### Modélisation

<!--% Chaque modèle doit être décrit à l'aide d'un graphique et d'un tableau résumant le modèle. Les équations paramétrées de tous les modèles doivent être également présentes. L'analyse des résidus sera réalisée et interprétée pour chaque modèle. -->

#### Régression linéaire 1

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r}
# Réalisation de modèles
lm(data=microp, fvfm ~ plast_tot) -> microp_lm1.1
chart(microp_lm1.1)
lm(data=microp, fvfm ~ plast_tot + I(plast_tot^2)) -> microp_lm1.2
chart(microp_lm1.2)
lm(data=microp, fvfm ~ plast_tot + I(plast_tot^2) + I(plast_tot^3)) -> microp_lm1.3
chart(microp_lm1.3)

```

```{r}
summary(microp_lm1.2) %>.%
  tabularise(.)
```

```{r}
chart$residuals(microp_lm1.2)
```

$$
`r eq__(microp_lm1.2, use_coefs = TRUE)`
$$

L'ajustement du modèle d'ordre 2 est visiblement meilleur, nous le gardons donc pour les analyses. La mise en graphique du modèle de l'efficacité de la concentration en microplastiques en fonction de l'efficacité de la photosynthèse du deuxième ordre ne montre pas une tendance linéaire mais plutot en parabole décroissante. Ce modèle a un R² ajusté assez faible et une p-value significative. Les p-valeurs de chaque paramètre sont aussi significatives. L'étude des résidus montre que l'étendue des résidus par rapport aux valeurs prédites est assez bonne ainsi que la linéarité du modèle. Plusieurs valeurs extrêmes sont observables (A). La distribution des résidus est normale, on observe cependant quelques valeurs extrêmes (B). Il n'y a pas d'homoscédatiscité des résidus (C) et l'effet de levier est conséquent ce qui est causé par plusieurs valeurs (D).

#### Régression linéaire 2

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r}
 
microp_lm2_1 <- lm(data= microp,  chla_fluo ~plast_tot + I(plast_tot))
chart(microp_lm2_1)
microp_lm2_2 <- lm(data= microp,  chla_fluo ~plast_tot + I(plast_tot^2))
chart(microp_lm2_2)
microp_lm2_3 <- lm(data = microp,  chla_fluo ~plast_tot + I(plast_tot^2) + I(plast_tot^3))
chart(microp_lm2_3)
```

```{r}
tabularise(summary_(microp_lm2_2))
```

```{r}
chart$residuals(microp_lm2_2)
```

$$
`r eq__(microp_lm2_2, use_coefs = TRUE)`
$$

L'ajustement du modèle d'ordre 2 est visiblement meilleur, nous le gardons donc pour les analyses. Le modèle est significatif au seuil alpha de 5%. Par contre, la variable alpha n'est pas significative au seuil alphe de 5% . Avec un R\^2 ajusté de 0.4938, le modèle est moyennement bon (plus celui sera proche de 1 , plus le modèle sera bon). L'intervalle de confiance est large est contient plus ou moins la moitié des valeurs. On observe plusieurs valeurs extrêmes. Les graphiques d'analyses de résidus nous montrent très clairement que le modèle laisse a désirer. En effet, le graphique A nous montre que les résidus sont assez fortement élevé par rapport aux valeurs prédites ( certains résidus valent plus de la moitié des valeurs prédites et que la courbe n est pas très bien alignée dans le nuage de point. Le graphique B nous montre que les résidus sont raisonnablement proche d'une distribution normale. Le graphique C montre une hétéroscédasticité flagrante (donc une non homogénéité des variances) . Le dernier graphique nous indique la présence d'une valeur avec un effet de levier important.

#### Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}
lm(data = microp, fvfm ~ plast_pvc * depth_rec)-> microp_lm3.1
summary(microp_lm3.1) %>.%
tabularise(.)
lm(data = microp, fvfm ~ plast_pvc + depth_rec)-> microp_lm3.2
summary(microp_lm3.2) %>.%
tabularise(.)
anova(microp_lm3.1, microp_lm3.2)
```

```{r}
chart(data = microp, fvfm ~ plast_pvc %col=% depth_rec) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

```{r}
chart$residuals(microp_lm3.2)
```

$$
`r eq__(microp_lm3.2, use_coefs = TRUE)`
$$

Le modèle avec interaction a des variables qui sont non significativement différentes de 0 au seuil alpha de 5%. Un modèle plus simple, en retirant les interactions a été effectué. Tous les paramètres sont significativement différents de 0 au seuil alpha de 5%. Un test anova a été effectué, il n'y a pas de différence significative au seuil alpha de 5% entre les deux modèles. Nous choisissons donc le modèle le plus simple. Le modèle de l'efficacité de la photosynthèse en fonction de de la concentration en plastique de type pvc et la profondeur montre que le R² ajusté est assez mauvais, mais les paramètres tels que sont tous significatifs. Nous avons choisi le modèle simple avec un décalage de l'ordonnée à l'origine car le modèle complet ne nous donnait pas de parametres tel que la pente significatif. La mise en graphique de notre modèle permet de montrer que la courbe pour une profondeur de -11.75 à -2.5 est croissante tandis que pour une profondeur de -2.5 à 1.75 est moins croissante et moins étendue. L'étude des résidus montre que l'étendue des résidus en fonction des valeurs prédites est assez bonne. La linéarité du modèle est moyenne(A). La normalité des résidus n'est pasbonne et des valeurs extrêmes sont observées pour les petites et grandes valeurs (B). Il n'y a pas d'homoscédatiscité (C). Pour certains points la distance de Cook est élevée, ces points sont visibles autant dans la partie supérieure à zéro que la partie inférieure à zéro, ces points ont une influence marquée c'est-à-dire un effet de levier marqué (D).

#### Modèle linéaire 2

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r}
microp_lm4.1 <- lm(data= microp, chla_fluo ~ plast_pe * temp_rec + 0)
tabularise(summary_(microp_lm4.1)) 
microp_lm4.2 <- lm(data= microp, chla_fluo ~ plast_pe * temp_rec)
tabularise(summary_(microp_lm4.2)) 
microp_lm4.3 <- lm(data= microp, chla_fluo ~ plast_pe + temp_rec)
tabularise(summary_(microp_lm4.3))
```

```{r}
AIC(microp_lm4.1, microp_lm4.2, microp_lm4.3)
anova(microp_lm4.2, microp_lm4.3)
```

```{r}
chart$residuals(microp_lm4.2)
```

```{r}
chart(data = microp, chla_fluo ~ plast_pe %col=% temp_rec) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

$$
`r eq__(microp_lm4.2, use_coefs = TRUE)`
$$

Pour le choix du modèle, différentes propositions ont été analysées. Le test choisi est celui avec interaction car le test anova nous montre qu'il y a significativement une différence entre les modèles avec et sans interaction. Nous avons essayé de déterminer s'il est possible de forcer à l'ordonnée à l'origine, les tests n'étant pas concluant, nous avons décidé de conserver le modèle le plus complexe. Le graphique semble indiquer que l'évolution de la masse de phytoplancton en fonction de la concentration en polyéthylène téréphtalate est différentes en fonction de la température. Le modèle est significatif au seuil alpha de 5%. Le R2 est mauvais avec une valeur de 0,0.3508. Toutes les termes sont significatifs de 5%. Cela signifie que la pente et l'ordonnée à l'origine sont différentes au seuil alpha de 5%. Il y a donc une différence significative de l'évolution de la masse de Phytoplancton en fonction de la température.Le modèle n'est pas forcé à passer par l'ordonnée à l'origine pour les données ayant été pris à une température entre 21 et 23.5°C.

L'étendue des résidus est élevée (2.5) par rapport à l'étendue des valeurs prédites(2.0). La courbe du nuage de point est relativement linéaire mais de nombreux points sont positionnés au même niveau (A). Les données ne suivent pas une distribution normale (B). La répartition des données ne montre pas un signe d'homoscédasticité (C), de nombreuses valeurs sont présentes en un même point. Il y a présence de quelques valeurs extrêmes (D). Après analyse des résidus, le modèle semble moins idéal qu'il l'était avant l'analyse surtout à cause de la répartition des données.

#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r}
microp_glm1 <- glm(data = microp, fvfm ~ ammonium * mesocosm, family = gaussian)
summary_(microp_glm1) |> tabularise()
microp_glm2 <- glm(data = microp, fvfm ~ ammonium + mesocosm, family = gaussian)
summary_(microp_glm2) |> tabularise()
```

```{r}
anova(microp_glm1, microp_glm2)

```

```{r}
chart$residuals(microp_glm2) 
```

```{r}
chart(data = microp, fvfm ~ ammonium %col=% mesocosm) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

$$
`r eq__(microp_glm2, use_coefs = TRUE)`
$$

Toutes les variables sont significatives au seuil alpha de 5% . Le delta entre déviance totale et déviance résiduelle est faible. Le modèle n'est pas très bon. Les variables mésocosm et ammonium ont un impact sur la photosynthèse selon le modèle linéaire généralisé. Malgré un AIC légèrement moins favorable, le modèle avec interactions est meilleur car le modèle sans interaction n'est pas significatif.

L'analyse des résidus montre que l'étendue des résidus est élevé (0.2) par rapport à celui des valeurs prédites (0.15), on observe aussi une non linéarité du modèle (A). Les résidus présente une légère normalité mais la distribution est asymétrique (en forme de S) (B). L'analyse des variances montre relativement une hétéroscédatiscité (C). Plusieurs valeurs extrêmes sont observées, la distance de Cooks est importante pour certains points qui tirent la courbe de part et d'autre d'où l'effet de levier observé (D).

#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r}
microp_glm1.2<- glm(data = microp, chla_fluo ~ plast_pet * temp, family = gaussian) 
summary_(microp_glm1.2) |> tabularise()

microp_glm2.2<- glm(data = microp, chla_fluo ~ plast_pet + temp, family = gaussian) 
summary_(microp_glm2.2) |> tabularise()

anova(microp_glm1.2, microp_glm2.2, test = "Chisq") |> tabularise()

```

```{r}
chart$residuals(microp_glm2.2)
```

```{r}
chart(data = microp, chla_fluo ~ plast_pet %col=% temp) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x)
```

Tous les paramètres de l'équation sont significativement différents de 0 au seuil alpha de 5% pour le modèle sans interaction. Le modèle avec interaction donne des paramètres non significatif au seuil alpha de 5%. Le modèle avec interaction (le plus complexe) a un AIC un peu plus faible (73.92 par rapport à 73.07). Pour déterminer quel modèle utiliser, une anova a été faite. Il n'y a significativement pas de différence au seuil alpha de 5% entre les deux modèles. Comme plusieurs variables sont non significatives avec le modèle le plus complexe, nous préférons choisir le modèle qui a un AIC un peu plus élevé (le plus simple). Le graphique représenté signale que les données sont relativement mal représentées par le modèle. L'intervalle de confiance du graphique étant élevé. L'analyse des résidus montre que le modèle possède plusieurs problèmes. L'étalement des résidus (2.5) est élevé par rapport à l'étalement des valeurs prédites (2.5) (A). Il n'y a pas de normalité des résidus (B). Il n'y a pas d'homoscédasticité des résidus (C). Il y a de plus présence de valeurs extrêmes avec des effets de levier et des distances de Cook élevées (D).

## Conclusion

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les modèles les plus pertinents que vous retenez ? -->

Le jeu de données étudié ne permet de réaliser que quelques modèles pertinents. Les modèles retenus sont celui de l'impact de la concentration totale de microplastique sur l'activité photosynthétique du phytoplancton et des bactéries (régression linéaire 1) et l'impact du Polychlorure de vinyle sur l'activité photosynthétique du phytoplancton et des bactéries en fonction de la profondeur (modèle linéaire 1). Les résultats, en accord avec la littérature, démontre une augmentation de l'efficacité photosynthétique avec celle de la concentration en microplastique.

## Références

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
